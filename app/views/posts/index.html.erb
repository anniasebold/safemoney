<% @title="SafeMoney" %>
<div id="index-post">
  <div class="container">
    <div class="row">
      
      <div class="col-md-8">
        <h1 class="my-4">
          Todas as Postagens
        </h1>

        <% @post.each do |post| %>
          <div class="card mb-4">
            <img class="card-img-top" src="http://placehold.it/750x300" alt="Card image cap">
            <!-- Card header -->
            <div class="card-header">
              <h2 class="card-title"><%= post.title %></h2>
              <% post.categories.each do |categorie| %>
                <%= link_to categorie.name, root_path, class: 'badge badge-info'%>
              <% end %>
            </div>
            <!-- Card body -->
            <div class="card-body">
              <p class="card-text"><%= post.text.truncate(250) %></p>
              
              <!-- Btn Read More -->
              <div class="d-flex">
                <div class="mr-auto align-self-center p-2">
                  <%= link_to post_path(post.id), class:"btn btn-primary" do %>
                    Leia mais
                    <i class="fas fa-arrow-right"></i>
                  <% end %>
                </div>
                <% if post.user.email == current_user.email %>
                  <%= link_to "Editar", edit_post_path(post.id), class: "btn btn-light align-self-center p-2 ml-2 mr-3 " %>
                  <%= link_to "Excluir", post_path(post.id), method: :delete, class: "btn btn-danger align-self-center p-2", data: {confirm: "Tem certeza que deseja remover a postagem #{post.title}?"} %>
                <% else %>
                  <%= link_to "Reportar", root_path, class: "btn btn-danger align-self-center p-2 ml-2" %>
                <% end %>
              </div>

            </div>

            <!-- Card footer -->
            <div class="card-footer text-muted">
                Postado em <%= l(post.created_at, format: :long) %>
                  por
                <%= link_to post.user.name, root_path %>
            </div>
          </div>
        <% end %>

        <!-- Pagination -->
        <div class="pagination">
          <%== pagy_bootstrap_nav(@pagy) %>
        </div>

      </div>

      <div class="col-md-4">

        <!-- Card Search -->
        <div class="card my-4">
          <h5 class="card-header">Buscar</h5>
          <div class="card-body"> 

            <div class="input-group">
              <%= form_tag posts_path, method: :get, class: "input-group" do %>
                <%= text_field_tag :search, params[:search], 
                  class: "form-control search", placeholder: "Busque por..."  %>
                <span class="input-group-btn">
                <%= submit_tag "Go!", class: "btn btn-secondary bg-primary"%>
                </span>
            </div>
            <div class="input-group">
              <small class="form-text text-muted">
                Pesquise por TÃ­tulo, Texto e Categoria
              </small>
            </div>
              <% end %>
          </div>
        </div>

        <!-- Categories Widget -->
        <div class="card my-4">
          <h5 class="card-header">Categories</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="#">Web Design</a>
                  </li>
                  <li>
                    <a href="#">HTML</a>
                  </li>
                  <li>
                    <a href="#">Freebies</a>
                  </li>
                </ul>
              </div>
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="#">JavaScript</a>
                  </li>
                  <li>
                    <a href="#">CSS</a>
                  </li>
                  <li>
                    <a href="#">Tutorials</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
  </div>
</div>